---
title: "sql_md"
output: github_document
parent: sql
nav_order: 1
---

--- 
layout: default 
title: SQL â€“ Applied 
parent: SQL 
nav_order: 1 
---

```{r setup, include=FALSE}
rm(list = ls(all = TRUE))
#knitr::opts_knit$set(root.dir = here::here())
knitr::opts_chunk$set(
  warning = FALSE,
  message = FALSE,
  results = "asis"
)
options(knitr.table.format = "markdown")
```

```{r}
install.packages(
  setdiff(
    c("DBI", "duckdb", "nycflights13", "tidyverse", "here"),
    rownames(installed.packages())
  )
)
```

```{r}
library(here)
library(DBI)
library(duckdb)
library(nycflights13)
library(tidyverse)
```

```{r}
# GitHub raw link for the DuckDB database file
url <- "https://github.com/AU-datascience/data/raw/main/413-613/flights.duckdb"

# Local path to save the file
dest <- here("sql", "flights.duckdb")

# Download the file
download.file(url, dest, mode = "wb")
```

```{r}
con <- dbConnect(duckdb(dbdir = "./flights.duckdb"))
class(con)
```

```{r}
res <- dbGetQuery(con, "
  SHOW TABLES;
")
knitr::kable(res)
```

<!-- ```{sql, connection=con}
SHOW TABLES;
```
-->